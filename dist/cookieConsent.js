"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var n=t(e);class l{static KEY_COOKIES="CC_COOKIES";static KEY_HAS_DECIDED="CC_USER_HAS_DECIDED";static compareCookies(e,t){if(e.length!==t.length)return!1;const a=Object.keys(t[0]).filter((e=>"consent"!==e));for(const n of e){const e=t.find((e=>e.name===n.name));if(!e)return!1;for(const t of a)if(n[t]!==e[t])return!1}return!0}static mergeCookies(e,t){return e.filter((e=>{const a=t.find((t=>t.name===e.name));return a&&(e.consent=a.consent),e}))}}class c{static prefix="cc";static generatePrefixedClass(e,t){if(!t)return"";return`${this.prefix}__${e}${t}`}static changeCustomProperties(e){const t=Object.keys(e);for(const a of t){const t=`--cc-color-${a}`;document.documentElement.style.setProperty(t,e[a])}}static retrieveStorageItem(e){const t=localStorage.getItem(e);if(!t)return;return JSON.parse(t)}static setStorageItem(e,t){const a=JSON.stringify(t);localStorage.setItem(e,a)}static removeStorageItem(e){localStorage.removeItem(e)}}const r=e.createContext(null);r.displayName="CookieContext";const o=({children:t})=>{const[a,o]=e.useState([]),[i,s]=e.useState(!0),[u,d]=e.useState(!1),[m,f]=e.useState((()=>{})),E=e=>{e?c.setStorageItem(l.KEY_HAS_DECIDED,e):c.removeStorageItem(l.KEY_HAS_DECIDED),s(e),d(!1)},k=(e,t)=>{const n=a.map((a=>{const n=a.mandatory,l=e.length<1,c=e.includes(a.name);return n||!l&&!c||(a.consent=t),a}));o(n)};return e.useEffect((()=>{const e=c.retrieveStorageItem(l.KEY_HAS_DECIDED);E(!0===e)}),[]),n.default.createElement(r.Provider,{value:{cookies:a,hasDecided:i,modify:u,loadCookies:e=>{const t=c.retrieveStorageItem(l.KEY_COOKIES);if(Array.isArray(t))if(l.compareCookies(t,e))o(t);else{const a=l.mergeCookies(e,t);c.setStorageItem(l.KEY_COOKIES,a),o(a)}else o(e)},changeCookieConsent:k,saveChanges:e=>{switch(e){case"accept":k([],!0);break;case"decline":k([],!1)}c.setStorageItem(l.KEY_COOKIES,a),m(a),E(!0)},toggleModifyState:()=>{d((e=>!e))},disableConsentTemporarily:()=>{s(!0)},setSaveEventHandler:f}},t)};class i{static langFile;static async setLanguageFile(e){const t=await(n=`../constants/lang_${e}.json`,Promise.resolve().then((function(){return a(require(n))})));var n;t&&(this.langFile=t)}static translate(e){return this.langFile?this.langFile[e]:e}}function s({language:t,cookies:a,colors:n,saveEventHandler:l}){const o=e.useContext(r);return e.useEffect((()=>{o&&l&&o.setSaveEventHandler((()=>l))}),[l]),e.useEffect((()=>{n&&c.changeCustomProperties(n)}),[n]),e.useEffect((()=>{o&&o.loadCookies(a)}),[a]),e.useEffect((()=>{i.setLanguageFile(t)}),[t]),null}function u({link:e,openNewTab:t=!0,children:a}){return n.default.createElement("a",{href:e,target:t?"_blank":"",rel:"noreferrer noopener nofollow"},a)}function d({small:e,children:t}){return n.default.createElement("p",{className:e?"sm":""},t)}function m({type:e,color:t,icon:a,onClick:l,children:r}){const o=c.generatePrefixedClass("btn--",t);return n.default.createElement("button",{className:`cc__btn cc__btn--${e} ${o}`,onClick:e=>{l&&l(e)}},a,r)}function f({thirdParty:e}){return n.default.createElement("div",{className:"cc__thirdpartylist__item"},n.default.createElement("h4",null,e.name),n.default.createElement(d,null,e.desc),n.default.createElement("div",{className:"links"},n.default.createElement(u,{link:e.privacyLink},n.default.createElement(m,{type:"tertiary"},i.translate("PRIVACY_POLICY"))),n.default.createElement(u,{link:e.optOutLink},n.default.createElement(m,{type:"tertiary"},i.translate("OPT_OUT")))))}function E({thirdParties:e}){return n.default.createElement("div",{className:"cc_list"},n.default.createElement("div",{className:"cc__thirdpartyheader"},n.default.createElement("h5",null,i.translate("THIRD_PARTY_PROVIDER"))),n.default.createElement("div",{className:"cc__thirdpartylist"},e.map((e=>n.default.createElement(f,{key:e.name,thirdParty:e})))))}d.defaultProps={small:!1},m.defaultProps={type:"primary"};const k=()=>n.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},n.default.createElement("path",{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"}));function _(){const t=e.useContext(r),a=e=>{t&&t.changeCookieConsent([],e)};return n.default.createElement(n.default.Fragment,null,n.default.createElement(m,{color:"accept",onClick:()=>a(!0)},i.translate("ACCEPT_ALL")),n.default.createElement(m,{color:"decline",onClick:()=>a(!1)},i.translate("DECLINE_ALL")),n.default.createElement(m,{color:"accent",icon:n.default.createElement(k,null),onClick:()=>{t&&t.saveChanges("close")}},i.translate("SAVE_AND_CLOSE")))}function C({checked:e,disabled:t,onClick:a}){const l=t?i.translate("DISABLED_TOOLTIP"):"";return n.default.createElement("div",{className:"cc__switch",title:l,onClick:()=>{a&&!t&&a()}},n.default.createElement("input",{type:"checkbox",checked:e,disabled:t,onChange:()=>{}}),n.default.createElement("span",null))}function g({cookie:t}){const a=e.useContext(r);return n.default.createElement("div",{className:"cc__cookielist__item"},n.default.createElement("h4",null,t.name),n.default.createElement("div",{className:"content"},n.default.createElement(d,null,t.desc),n.default.createElement(C,{checked:t.consent,disabled:t.mandatory,onClick:()=>{a&&a.changeCookieConsent([t.name],!t.consent)}})))}function p({cookies:t}){const[a,l]=e.useState(0),c=[...new Set(t.map((e=>e.group)))];return n.default.createElement("div",{className:"cc__list"},n.default.createElement("div",{className:"cc__cookieheader"},c.map(((e,t)=>n.default.createElement("h5",{key:e,className:"group "+(t===a?"active":""),onClick:()=>(e=>{l(e)})(t)},e)))),n.default.createElement("div",{className:"cc__cookielist"},t.filter((e=>e.group===c[a])).map((e=>n.default.createElement(g,{key:e.name,cookie:e})))))}function v({cookieLink:e,privacyLink:t,actionButtons:a}){return n.default.createElement("div",{className:"cc__btn__group"},n.default.createElement("div",{className:"secondary"},n.default.createElement(u,{link:t},n.default.createElement(m,{type:"tertiary"},i.translate("PRIVACY_POLICY"))),e&&n.default.createElement(u,{link:e},n.default.createElement(m,{type:"tertiary"},i.translate("COOKIE_POLICY")))),n.default.createElement("div",{className:"action"},a))}C.defaultProps={disabled:!1};const y=({onClick:e})=>n.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 352 512",onClick:()=>{e&&e()}},n.default.createElement("path",{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}));function h({children:e}){return n.default.createElement("div",{className:"cc__title"},n.default.createElement("h3",null,e))}function P({name:t,preamble:a,thirdPartyProvider:l,privacyPolicyLink:c,cookiePolicyLink:o}){const s=e.useContext(r);if(s&&(s.hasDecided||!s.modify))return null;return n.default.createElement("div",{className:"cc__container cc__container--modify"},n.default.createElement("div",{className:"wrapper"},n.default.createElement(y,{onClick:()=>{s&&s.toggleModifyState()}}),n.default.createElement(h,null,t," ",i.translate("TITLE")),n.default.createElement(d,null,a),n.default.createElement("div",{className:"cc__scroller cc__scroller--max"},s&&s.cookies.length>0&&n.default.createElement(p,{cookies:s.cookies}),l.length>0&&n.default.createElement(E,{thirdParties:l})),n.default.createElement(v,{privacyLink:c,cookieLink:o,actionButtons:n.default.createElement(_,null)})))}const L=()=>n.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},n.default.createElement("path",{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}));function S(){const t=e.useContext(r),a=e=>{t&&t.saveChanges(e)};return n.default.createElement(n.default.Fragment,null,n.default.createElement(m,{color:"accept",icon:n.default.createElement(k,null),onClick:()=>a("accept")},i.translate("BUTTON_ACCEPT")),n.default.createElement(m,{color:"decline",icon:n.default.createElement(y,null),onClick:()=>a("decline")},i.translate("BUTTON_DECLINE")),n.default.createElement(m,{color:"secondary",icon:n.default.createElement(L,null),onClick:()=>{t&&t.toggleModifyState()}},i.translate("BUTTON_MODIFY")))}function I({name:t,preamble:a,privacyPolicyLink:l,cookiePolicyLink:c}){const o=e.useContext(r);if(o&&(o.hasDecided||o.modify))return null;return n.default.createElement("div",{className:"cc__container cc__container--small"},n.default.createElement("div",null,n.default.createElement(y,{onClick:()=>{o&&o.disableConsentTemporarily()}}),n.default.createElement(h,null,t," ",i.translate("TITLE")),n.default.createElement(d,null,a),n.default.createElement(v,{privacyLink:l,cookieLink:c,actionButtons:n.default.createElement(S,null)})))}exports.CookieConsent=function({name:e,activated:t=!0,language:a="en",preamble:l,privacyPolicyLink:c,cookiePolicyLink:r,cookies:i=[],thirdPartyProvider:u=[],onSave:d,colors:m}){return n.default.createElement(o,null,n.default.createElement(s,{language:a,cookies:i,colors:m,saveEventHandler:d}),n.default.createElement("div",{className:"cc__gimme-cookies"},n.default.createElement(I,{name:e,preamble:l,privacyPolicyLink:c,cookiePolicyLink:r}),n.default.createElement(P,{name:e,preamble:l,thirdPartyProvider:u,privacyPolicyLink:c,cookiePolicyLink:r})))};
//# sourceMappingURL=cookieConsent.js.map
