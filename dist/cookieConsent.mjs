import e,{createContext as t,useState as n,useEffect as c,useContext as a}from"react";class l{static KEY_COOKIES="CC_COOKIES";static KEY_HAS_DECIDED="CC_USER_HAS_DECIDED";static compareCookies(e,t){if(e.length!==t.length)return!1;const n=Object.keys(t[0]).filter((e=>"consent"!==e));for(const c of e){const e=t.find((e=>e.name===c.name));if(!e)return!1;for(const t of n)if(c[t]!==e[t])return!1}return!0}static mergeCookies(e,t){return e.filter((e=>{const n=t.find((t=>t.name===e.name));return n&&(e.consent=n.consent),e}))}}class r{static prefix="cc";static generatePrefixedClass(e,t){if(!t)return"";return`${this.prefix}__${e}${t}`}static changeCustomProperties(e){const t=Object.keys(e);for(const n of t){const t=`--cc-color-${n}`;document.documentElement.style.setProperty(t,e[n])}}static retrieveStorageItem(e){const t=localStorage.getItem(e);if(!t)return;return JSON.parse(t)}static setStorageItem(e,t){const n=JSON.stringify(t);localStorage.setItem(e,n)}static removeStorageItem(e){localStorage.removeItem(e)}}const o=t(null);o.displayName="CookieContext";const i=({children:t})=>{const[a,i]=n([]),[s,m]=n(!0),[E,d]=n(!1),[u,k]=n((()=>{})),_=e=>{e?r.setStorageItem(l.KEY_HAS_DECIDED,e):r.removeStorageItem(l.KEY_HAS_DECIDED),m(e),d(!1)},g=(e,t)=>{const n=a.map((n=>{const c=n.mandatory,a=e.length<1,l=e.includes(n.name);return c||!a&&!l||(n.consent=t),n}));i(n)};return c((()=>{const e=r.retrieveStorageItem(l.KEY_HAS_DECIDED);_(!0===e)}),[]),e.createElement(o.Provider,{value:{cookies:a,hasDecided:s,modify:E,loadCookies:e=>{const t=r.retrieveStorageItem(l.KEY_COOKIES);if(Array.isArray(t))if(l.compareCookies(t,e))i(t);else{const n=l.mergeCookies(e,t);r.setStorageItem(l.KEY_COOKIES,n),i(n)}else i(e)},changeCookieConsent:g,saveChanges:e=>{switch(e){case"accept":g([],!0);break;case"decline":g([],!1)}r.setStorageItem(l.KEY_COOKIES,a),u(a),_(!0)},toggleModifyState:()=>{d((e=>!e))},disableConsentTemporarily:()=>{m(!0)},setSaveEventHandler:k}},t)};class s{static langFile;static async setLanguageFile(e){const t=await import(`../constants/lang_${e}.json`);t&&(this.langFile=t)}static translate(e){return this.langFile?this.langFile[e]:e}}function m({language:e,cookies:t,colors:n,saveEventHandler:l}){const i=a(o);return c((()=>{i&&l&&i.setSaveEventHandler((()=>l))}),[l]),c((()=>{n&&r.changeCustomProperties(n)}),[n]),c((()=>{i&&i.loadCookies(t)}),[t]),c((()=>{s.setLanguageFile(e)}),[e]),null}function E({link:t,openNewTab:n=!0,children:c}){return e.createElement("a",{href:t,target:n?"_blank":"",rel:"noreferrer noopener nofollow"},c)}function d({small:t,children:n}){return e.createElement("p",{className:t?"sm":""},n)}function u({type:t,color:n,icon:c,onClick:a,children:l}){const o=r.generatePrefixedClass("btn--",n);return e.createElement("button",{className:`cc__btn cc__btn--${t} ${o}`,onClick:e=>{a&&a(e)}},c,l)}function k({thirdParty:t}){return e.createElement("div",{className:"cc__thirdpartylist__item"},e.createElement("h4",null,t.name),e.createElement(d,null,t.desc),e.createElement("div",{className:"links"},e.createElement(E,{link:t.privacyLink},e.createElement(u,{type:"tertiary"},s.translate("PRIVACY_POLICY"))),e.createElement(E,{link:t.optOutLink},e.createElement(u,{type:"tertiary"},s.translate("OPT_OUT")))))}function _({thirdParties:t}){return e.createElement("div",{className:"cc_list"},e.createElement("div",{className:"cc__thirdpartyheader"},e.createElement("h5",null,s.translate("THIRD_PARTY_PROVIDER"))),e.createElement("div",{className:"cc__thirdpartylist"},t.map((t=>e.createElement(k,{key:t.name,thirdParty:t})))))}d.defaultProps={small:!1},u.defaultProps={type:"primary"};const g=()=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e.createElement("path",{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"}));function p(){const t=a(o),n=e=>{t&&t.changeCookieConsent([],e)};return e.createElement(e.Fragment,null,e.createElement(u,{color:"accept",onClick:()=>n(!0)},s.translate("ACCEPT_ALL")),e.createElement(u,{color:"decline",onClick:()=>n(!1)},s.translate("DECLINE_ALL")),e.createElement(u,{color:"accent",icon:e.createElement(g,null),onClick:()=>{t&&t.saveChanges("close")}},s.translate("SAVE_AND_CLOSE")))}function C({checked:t,disabled:n,onClick:c}){const a=n?s.translate("DISABLED_TOOLTIP"):"";return e.createElement("div",{className:"cc__switch",title:a,onClick:()=>{c&&!n&&c()}},e.createElement("input",{type:"checkbox",checked:t,disabled:n,onChange:()=>{}}),e.createElement("span",null))}function v({cookie:t}){const n=a(o);return e.createElement("div",{className:"cc__cookielist__item"},e.createElement("h4",null,t.name),e.createElement("div",{className:"content"},e.createElement(d,null,t.desc),e.createElement(C,{checked:t.consent,disabled:t.mandatory,onClick:()=>{n&&n.changeCookieConsent([t.name],!t.consent)}})))}function y({cookies:t}){const[c,a]=n(0),l=[...new Set(t.map((e=>e.group)))];return e.createElement("div",{className:"cc__list"},e.createElement("div",{className:"cc__cookieheader"},l.map(((t,n)=>e.createElement("h5",{key:t,className:"group "+(n===c?"active":""),onClick:()=>(e=>{a(e)})(n)},t)))),e.createElement("div",{className:"cc__cookielist"},t.filter((e=>e.group===l[c])).map((t=>e.createElement(v,{key:t.name,cookie:t})))))}function h({cookieLink:t,privacyLink:n,actionButtons:c}){return e.createElement("div",{className:"cc__btn__group"},e.createElement("div",{className:"secondary"},e.createElement(E,{link:n},e.createElement(u,{type:"tertiary"},s.translate("PRIVACY_POLICY"))),t&&e.createElement(E,{link:t},e.createElement(u,{type:"tertiary"},s.translate("COOKIE_POLICY")))),e.createElement("div",{className:"action"},c))}C.defaultProps={disabled:!1};const f=({onClick:t})=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 352 512",onClick:()=>{t&&t()}},e.createElement("path",{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}));function L({children:t}){return e.createElement("div",{className:"cc__title"},e.createElement("h3",null,t))}function P({name:t,preamble:n,thirdPartyProvider:c,privacyPolicyLink:l,cookiePolicyLink:r}){const i=a(o);if(i&&(i.hasDecided||!i.modify))return null;return e.createElement("div",{className:"cc__container cc__container--modify"},e.createElement("div",{className:"wrapper"},e.createElement(f,{onClick:()=>{i&&i.toggleModifyState()}}),e.createElement(L,null,t," ",s.translate("TITLE")),e.createElement(d,null,n),e.createElement("div",{className:"cc__scroller cc__scroller--max"},i&&i.cookies.length>0&&e.createElement(y,{cookies:i.cookies}),c.length>0&&e.createElement(_,{thirdParties:c})),e.createElement(h,{privacyLink:l,cookieLink:r,actionButtons:e.createElement(p,null)})))}const I=()=>e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e.createElement("path",{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}));function S(){const t=a(o),n=e=>{t&&t.saveChanges(e)};return e.createElement(e.Fragment,null,e.createElement(u,{color:"accept",icon:e.createElement(g,null),onClick:()=>n("accept")},s.translate("BUTTON_ACCEPT")),e.createElement(u,{color:"decline",icon:e.createElement(f,null),onClick:()=>n("decline")},s.translate("BUTTON_DECLINE")),e.createElement(u,{color:"secondary",icon:e.createElement(I,null),onClick:()=>{t&&t.toggleModifyState()}},s.translate("BUTTON_MODIFY")))}function N({name:t,preamble:n,privacyPolicyLink:c,cookiePolicyLink:l}){const r=a(o);if(r&&(r.hasDecided||r.modify))return null;return e.createElement("div",{className:"cc__container cc__container--small"},e.createElement("div",null,e.createElement(f,{onClick:()=>{r&&r.disableConsentTemporarily()}}),e.createElement(L,null,t," ",s.translate("TITLE")),e.createElement(d,null,n),e.createElement(h,{privacyLink:c,cookieLink:l,actionButtons:e.createElement(S,null)})))}function O({name:t,activated:n=!0,language:c="en",preamble:a,privacyPolicyLink:l,cookiePolicyLink:r,cookies:o=[],thirdPartyProvider:s=[],onSave:E,colors:d}){return e.createElement(i,null,e.createElement(m,{language:c,cookies:o,colors:d,saveEventHandler:E}),e.createElement("div",{className:"cc__gimme-cookies"},e.createElement(N,{name:t,preamble:a,privacyPolicyLink:l,cookiePolicyLink:r}),e.createElement(P,{name:t,preamble:a,thirdPartyProvider:s,privacyPolicyLink:l,cookiePolicyLink:r})))}export{O as CookieConsent};
//# sourceMappingURL=cookieConsent.mjs.map
